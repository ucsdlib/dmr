<!--JWPlayer player config. and script-->

<div id="player">Loading the player...</div>

<% if @course.reports and @course.reports.size > 0 %> 
  <script type="text/javascript">
    jwplayer("player").setup({
      playlist: [{
      <% @sorted_media.each do |m| %>
        <%  wowzaURL = grab_wowza_url(m.file_name,m.id) if !m.nil?%>
        <% if wowzaURL != nil %>
          <% thumbnailURL = "#{Rails.configuration.file_path}#{m.file_name.gsub('.mp4','.jpg')}"%>      
	      sources: [
	        {file: "rtmp://<%=wowzaURL%>"},
	        {file: "http://<%=wowzaURL%>/playlist.m3u8"}
	      ],
	      <!--title of media file-->
	      title: "<%= m.title %>",
	      
          <!--Brief media description text area-->
	      description: "Director: <%= m.director %> <br/>Year: <%= m.year %>",
	  	  
	      <!--add image: to display thumbnail-->
	      image: "<%= thumbnailURL%>"
	  
          },{
        <% end %>
      <% end %>
	
      }],
      rtmp: {
        bufferlength: 5,
      },
	  //listbar: {
      //  position: 'right',
      //  size: "25%",
      //},
	  width: "100%",
	  height: "100%",
	  aspectratio: "16:6",
	  skin: 'glow'
    });
	jwplayer().onReady(function(){
      var myVideos = jwplayer().getPlaylist();
      for (var i = 0; i < myVideos.length; i++) {
		//document.getElementById('listbar').innerHTML += '<div class=listbar_item id=video'+ i +' onClick="jwplayer().playlistItem(' + i + ');jwplayer().play();"><div class="playlist_left"><img class="playlist_thumbnail" src=' + myVideos[i].image + '></div><div class="playlist_right"><span class="playlist_text"><b>' + myVideos[i].title + '</b><br/><span class="desc">' + myVideos[i].description + '</span></span></div></div><div class="jwplaylistdivider"></div>';
		//document.getElementById('listbar').innerHTML += '<div style="display: flex; margin: 10px 0 10px 10px; width:95%; height:70px; " class=listbar_item id=video'+ i +' onClick="jwplayer().playlistItem(' + i + ');jwplayer().play();"><div style="flex: 0 0 10%;"><img class="playlist_thumbnail" src=' + myVideos[i].image + '></div><div style="flex:1; line-height: 75px;"><span class="playlist_text"><b>' + myVideos[i].title + '</b><br/><span class="desc">' + myVideos[i].description + '</span></span></div></div><div class="jwplaylistdivider"></div>';
        document.getElementById('list').innerHTML += '<li><span class="dropt" title="'+myVideos[i].title+'"><a href="javascript:jwplayer().playlistItem(' + i + ');jwplayer().play()"><img class="img-responsive" src="'+myVideos[i].image+'" <="" img="" height="75" width="120"><br>'+myVideos[i].title+'<br/>'+myVideos[i].description+'</a><br><span style="width:500px;" <="" span=""></span></span></li>';
	  } 
	});
	jwplayer().onPlaylist(function(){		
	});
  </script>
<% end %>